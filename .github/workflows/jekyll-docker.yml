name: Deploy HTML Project
on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Install dependencies (if any)
        run: |
          if [ -f "package.json" ]; then
            npm ci
          else
            echo "No package.json found, skipping npm install"
          fi

      - name: Validate HTML
        run: |
          # Check if index.html exists
          if [ -f "index.html" ]; then
            echo "‚úÖ Found index.html"
            # Simple HTML validation - check for basic structure
            if grep -q "<!DOCTYPE html>" index.html && grep -q "<html" index.html; then
              echo "‚úÖ HTML structure looks good"
            else
              echo "‚ö†Ô∏è  Warning: Basic HTML structure might be missing"
            fi
          else
            echo "‚ùå No index.html found in root directory"
            exit 1
          fi

      - name: Check HTML file
        run: |
          # Check file size
          if [ -f "index.html" ]; then
            FILESIZE=$(stat -c%s "index.html")
            echo "üìÑ index.html file size: $FILESIZE bytes"

            # Check for common HTML issues
            echo "üîç Checking HTML structure..."

            # Check for required tags
            REQUIRED_TAGS=("<!DOCTYPE html>" "<html" "<head>" "<body>")
            for tag in "${REQUIRED_TAGS[@]}"; do
              if grep -q "$tag" index.html; then
                echo "‚úÖ Found: $tag"
              else
                echo "‚ö†Ô∏è  Missing: $tag"
              fi
            done

            # Count elements
            echo "üìä Element counts:"
            echo "  <div> tags: $(grep -c "<div" index.html || echo 0)"
            echo "  <p> tags: $(grep -c "<p>" index.html || echo 0)"
            echo "  <img> tags: $(grep -c "<img" index.html || echo 0)"
            echo "  <video> tags: $(grep -c "<video" index.html || echo 0)"
          fi

      - name: Build status
        run: |
          echo "üéâ HTML project build and validation completed successfully!"
          echo "Project structure:"
          ls -la
